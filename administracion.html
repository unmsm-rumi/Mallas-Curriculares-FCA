<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malla Curricular</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .panel-superior {
            max-width: 1200px;
            margin: 20px auto;
            display: flex;
            gap: 40px;
            justify-content: center;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .progreso {
            background-color: #e6f0ff;
            border: 1px solid #99bbff;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            min-width: 250px;
            max-width: 520px;
            flex: 1 1 300px;
        }
        
        .barra-contenedor {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .barra-externa {
            flex: 1;
            width: 100%;
            background-color: #cce0ff;
            border-radius: 10px;
            overflow: hidden;
            height: 16px;
            margin: 8px 0;
        }
        
        .barra-interna {
            height: 100%;
            background-color: #3366cc;
            width: 0%;
            transition: width 0.4s ease;
        }
        
        .porcentaje {
            font-weight: bold;
            color: #0066cc;
        }
        
        .progreso button {
            padding: 10px 20px;
            background-color: #4d94ff;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
            transition: background-color 0.3s ease;
        }
        
        .progreso button:hover {
            background-color: #1a75ff;
        }
        
        .malla-container {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 20px; 
            padding-bottom: 20px;
            max-width: 150vw;
            box-sizing: border-box;
        }
        
        .ciclo {
            width: 280px;
            max-width: 320px;
            min-width: 320px;
            flex-shrink: 0;
            background-color: #e6f0ff;
            border-radius: 12px;
            padding: 15px;
            border: 1px solid #99ccff;
        }
        
        .ciclo h2 {
            color: #0047b3;
            text-align: center;
            font-size: 18px;
            margin-bottom: 15px;
        }
        
        .curso {
            width: 100%;
            box-sizing: border-box;
            position: relative;
            padding: 10px;
            background-color: #f0f8ff;
            border-radius: 10px;
            border: 1px solid #99bbff;
            cursor: default;
            transition: all 0.3s ease;
            text-align: center;
            margin-bottom: 10px;
            opacity: 0.6;
        }
        
        .curso.activo {
            background-color: #cce5ff;
            border-color: #0047b3;
            color: #0047b3;
            font-weight: bold;
            cursor: pointer;
            opacity: 1;
        }
        
        .curso.tildado {
            text-decoration: line-through;
            background-color: #d1e0f5;
            color: #777;
            opacity: 1;
            cursor: pointer;
        }
        
        .curso.electiva {
            border: 2px dashed #66a3ff;
            background-color: #e6f0ff;
        }
        
        .tooltip {
            position: absolute;
            bottom: 110%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #fff;
            border: 1px solid #b3d1ff;
            border-radius: 6px;
            padding: 8px;
            font-size: 13px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            display: none;
            white-space: pre-line;
            z-index: 100;
        }
        
        .curso:hover .tooltip {
            display: block;
        }
        
        .curso.bloqueado::after {
            content: 'üîí';
            position: absolute;
            right: 10px;
            top: 10px;
        }
        
        .selector-electivas {
            margin: 20px auto;
            padding: 20px;
            background-color: #f0f8ff;
            border: 1px solid #99bbff;
            border-radius: 12px;
            min-width: 250px;
            max-width: 300px;
            flex: 1 1 280px;
        }

        html {
            overflow-x: hidden;
        }  
    </style>
</head>
<body>
    <div class="panel-superior">
        <div class="progreso">
            <p><strong>Cr√©ditos completados: <span id="creditos">0</span> / <span id="total-creditos">0</span> <span id="info-extra-creditos">(m√≠n: 220)</span></strong></p>

            <div class="barra-contenedor">
                <div class="barra-externa">
                    <div class="barra-interna" id="barra-progreso" style="width: 0%;"></div>
                </div>
                <p><span id="porcentaje">0</span> %</p>
            </div>
            
            <button id="reset">Restablecer progreso</button>
        </div>

        <div class="selector-electivas" id="electivas">
            <strong>Elige tus 2 √°reas electivas:</strong><br>
            <label><input type="checkbox" class="opt" value="talento"> üë• Talento Humano </label><br>
            <label><input type="checkbox" class="opt" value="finanzas"> üè¶ Finanzas </label><br>
            <label><input type="checkbox" class="opt" value="proyectos"> üìÅ Proyectos </label><br>
            <label><input type="checkbox" class="opt" value="marketing"> üí° Marketing </label><br>
            <label><input type="checkbox" class="opt" value="log√≠stica"> üè≠ Log√≠stica</label>
        </div>
    </div>

    <div class="malla-container" id="contenedor-cursos"></div>

    <script>
        const cursos = [
            // 1er ciclo
            { nombre: "Lenguaje", creditos: 4, ciclo: 1 },
            { nombre: "M√©todos de estudio universitario", creditos: 3, ciclo: 1 },
            { nombre: "Historia del Per√∫", creditos: 3, ciclo: 1 },
            { nombre: "Matem√°tica I", creditos: 4, ciclo: 1 },
            { nombre: "Desarrollo personal", creditos: 3, ciclo: 1 },
            { nombre: "Ingl√©s I", creditos: 2, ciclo: 1 },
            // 2do ciclo
            { nombre: "Investigaci√≥n Acad√©mica", creditos: 3, ciclo: 2 },
            { nombre: "Filosof√≠a y √âtica", creditos: 3, ciclo: 2 },
            { nombre: "Realidad Nacional y Mundial", creditos: 3, ciclo: 2 },
            { nombre: "Matem√°tica II", creditos: 4, ciclo: 2, prereq: ["Matem√°tica I"] },
            { nombre: "Derechos Fundamentales", creditos: 3, ciclo: 2 },
            { nombre: "Ingl√©s II", creditos: 2, ciclo: 2, prereq: ["Ingl√©s I"] },
            // 3er ciclo
            { nombre: "Estad√≠stica Descriptiva", creditos: 4, ciclo: 3 },
            { nombre: "Microeconom√≠a", creditos: 3, ciclo: 3 },
            { nombre: "Visi√≥n para el Desarrollo", creditos: 3, ciclo: 3, prereq: ["Investigaci√≥n Acad√©mica"] },
            { nombre: "Fundamentos de la Administraci√≥n", creditos: 4, ciclo: 3 },
            { nombre: "TICs para la Gesti√≥n", creditos: 3, ciclo: 3 },
            { nombre: "Fundamentos de la Contabilidad", creditos: 3, ciclo: 3 },
            { nombre: "Desarrollo Sostenible", creditos: 2, ciclo: 3 },

            // 4to ciclo
            { nombre: "Estad√≠stica Inferencial", creditos: 4, ciclo: 4, prereq: ["Estad√≠stica Descriptiva"] },
            { nombre: "Macroeconom√≠a", creditos: 3, ciclo: 4, prereq: ["Microeconom√≠a"] },
            { nombre: "Derecho Empresarial", creditos: 3, ciclo: 4 },
            { nombre: "Investigaci√≥n Cient√≠fica", creditos: 3, ciclo: 4, prereq: ["Visi√≥n para el Desarrollo"] },
            { nombre: "Procesos Administrativos", creditos: 4, ciclo: 4, prereq: ["Fundamentos de la Administraci√≥n"] },
            { nombre: "Costos y presupuestos", creditos: 3, ciclo: 4, prereq: ["Fundamentos de la Contabilidad"] },
            { nombre: "Matem√°tica financiera", creditos: 4, ciclo: 4 },

            // 5to ciclo
            { nombre: "Derecho Laboral", creditos: 2, ciclo: 5, prereq: ["Derecho Empresarial"] },
            { nombre: "Administraci√≥n de la Calidad", creditos: 3, ciclo: 5, prereq: ["Procesos Administrativos"] },
            { nombre: "Fundamentos del Talento Humano", creditos: 3, ciclo: 5},
            { nombre: "Finanzas Corporativas I", creditos: 3, ciclo: 5, prereq: ["Matem√°tica financiera"] },
            { nombre: "Herramientas para el Desarrollo de Proyectos", creditos: 3, ciclo: 5 },
            { nombre: "Fundamentos de Marketing", creditos: 3, ciclo: 5 },
            { nombre: "Cadenas de Suministros", creditos: 3, ciclo: 5 },
            { nombre: "Emprendimiento e innovaci√≥n", creditos: 3, ciclo: 5 },
            // 6to ciclo
            { nombre: "M√©todos Cuantitativos", creditos: 3, ciclo: 6, prereq: ["Estad√≠stica Inferencial"] },
            { nombre: "Investigaci√≥n de Mercados", creditos: 3, ciclo: 6 },
            { nombre: "Derecho Tributario", creditos: 2, ciclo: 6, prereq: ["Derecho Laboral"] },
            { nombre: "T√©cnicas de Investigaci√≥n Cualitativa", creditos: 3, ciclo: 6, prereq: ["Investigaci√≥n Cient√≠fica"] },
            { nombre: "Reestructuraci√≥n, Mejoramiento y Cambio Empresarial", creditos: 3, ciclo: 6, prereq: ["Administraci√≥n de la Calidad"] },
            { nombre: "Reclutamiento y Selecci√≥n del Talento", creditos: 3, ciclo: 6, prereq: ["Fundamentos del Talento Humano"], area: "talento"  },
            { nombre: "Seguridad y salud en el trabajo", creditos: 3, ciclo: 6, area: "talento"  },
            { nombre: "Finanzas Corporativas II", creditos: 3, ciclo: 6, prereq: ["Finanzas Corporativas I"], area: "finanzas"  },
            { nombre: "Formulaci√≥n y evaluaci√≥n de proyectos de Inversi√≥n", creditos: 3, ciclo: 6, prereq: ["Herramientas para el Desarrollo de Proyectos"], area: "proyectos"  },
            { nombre: "Marketing Digital", creditos: 3, ciclo: 6, prereq: ["Fundamentos de Marketing"], area: "marketing"  },
            { nombre: "Comportamiento del consumidor", creditos: 3, ciclo: 6, area: "marketing"   },
            { nombre: "Planeaci√≥n de la demanda, pron√≥sticos y simuladores", creditos: 3, ciclo: 6, area: "log√≠stica"  },
            { nombre: "Investigaci√≥n, desarrollo e innovaci√≥n", creditos: 3, ciclo: 6, area: "log√≠stica"   },
            // 7mo ciclo
            { nombre: "Negocios Internacionales", creditos: 4, ciclo: 7 },
            { nombre: "T√©cnicas de Investigaci√≥n Cuantitativa", creditos: 3, ciclo: 7, prereq: ["T√©cnicas de Investigaci√≥n Cualitativa"] },
            { nombre: "Prospectiva Empresarial", creditos: 3, ciclo: 7, prereq: ["Reestructuraci√≥n, Mejoramiento y Cambio Empresarial"] },
            { nombre: "Capacitaci√≥n y Desarrollo del talento", creditos: 3, ciclo: 7, prereq: ["Reclutamiento y Selecci√≥n del Talento"], area: "talento"  },
            { nombre: "Gesti√≥n del clima, cultura y comunicaci√≥n organizacional", creditos: 3, ciclo: 7, area: "talento"  },
            { nombre: "Mercado de Capitales", creditos: 3, ciclo: 7, prereq: ["Finanzas Corporativas II"], area: "finanzas"  },
            { nombre: "Derivados financieros", creditos: 3, ciclo: 7, area: "finanzas"  },
            { nombre: "Formulaci√≥n y evaluaci√≥n de proyectos sociales I", creditos: 3, ciclo: 7, prereq: ["Formulaci√≥n y evaluaci√≥n de proyectos de Inversi√≥n"], area: "proyectos"  },
            { nombre: "Gesti√≥n de Riesgos de los Proyectos", creditos: 3, ciclo: 7, area: "proyectos"  },
            { nombre: "Marketing de servicios", creditos: 3, ciclo: 7, prereq: ["Marketing Digital"], area: "marketing"  },
            { nombre: "Programaci√≥n Neuroling√º√≠stica", creditos: 3, ciclo: 7, area: "marketing"  },
            { nombre: "Operaciones I", creditos: 3, ciclo: 7, area: "log√≠stica"  },
            { nombre: "Aprovisionamiento y negociaci√≥n", creditos: 3, ciclo: 7, area: "log√≠stica"  },
            // 8vo ciclo
            { nombre: "Integraci√≥n Econ√≥mica", creditos: 3, ciclo: 8, prereq: ["Negocios Internacionales"] },
            { nombre: "Proyecto de Investigaci√≥n", creditos: 3, ciclo: 8, prereq: ["T√©cnicas de Investigaci√≥n Cuantitativa"] },
            { nombre: "Planeamiento Estrat√©gico", creditos: 3, ciclo: 8, prereq: ["Prospectiva Empresarial"] },
            { nombre: "Gesti√≥n P√∫blica", creditos: 3, ciclo: 8 },
            { nombre: "Evaluaci√≥n del desempe√±o laboral", creditos: 3, ciclo: 8, prereq: ["Capacitaci√≥n y Desarrollo del talento"], area: "talento"  },
            { nombre: "Inteligencia Emocional y Social", creditos: 3, ciclo: 8, area: "talento"  },
            { nombre: "Finanzas Internacionales", creditos: 3, ciclo: 8, prereq: ["Mercado de Capitales"], area: "finanzas"  },
            { nombre: "Econometr√≠a Financiera", creditos: 3, ciclo: 8, area: "finanzas"  },
            { nombre: "Formulaci√≥n y evaluaci√≥n de proyectos sociales II", creditos: 3, ciclo: 8, prereq: ["Formulaci√≥n y evaluaci√≥n de proyectos sociales I"], area: "proyectos"  },
            { nombre: "Gesti√≥n de proyectos p√∫blicos y privados", creditos: 3, ciclo: 8, area: "proyectos"  },
            { nombre: "Marketing internacional", creditos: 3, ciclo: 8, prereq: ["Marketing de servicios"], area: "marketing"  },
            { nombre: "Publicidad y Branding", creditos: 3, ciclo: 8, area: "marketing"  },
            { nombre: " Operaciones II", creditos: 3, ciclo: 8, area: "log√≠stica"  },
            { nombre: "Gesti√≥n de almacenes e inventarios", creditos: 3, ciclo: 8, area: "log√≠stica"  },
            // 9no ciclo
            { nombre: "Cadena de Valor", creditos: 3, ciclo: 9 },
            { nombre: "Desarrollo de Investigaci√≥n I", creditos: 3, ciclo: 9, prereq: ["Proyecto de Investigaci√≥n"] },
            { nombre: "Direcci√≥n Estrat√©gica", creditos: 3, ciclo: 9, prereq: ["Planeamiento Estrat√©gico"] },
            { nombre: "Desarrollo y Lanzamiento de Nuevos Productos", creditos: 3, ciclo: 9 },
            { nombre: "Valoraci√≥n de puestos y gesti√≥n de las compensaciones", creditos: 3, ciclo: 9, prereq: ["Evaluaci√≥n del desempe√±o laboral"], area: "talento"  },
            { nombre: "Gesti√≥n del Talento Humano en el sector p√∫blico", creditos: 3, ciclo: 9, area: "talento"  },
            { nombre: "Gesti√≥n de Riesgos Financieros", creditos: 3, ciclo: 9, prereq: ["Finanzas Internacionales"], area: "finanzas"  },
            { nombre: "Finanzas P√∫blicas", creditos: 3, ciclo: 9, area: "finanzas"  },
            { nombre: "Gerencia de Proyectos", creditos: 3, ciclo: 9, prereq: ["Formulaci√≥n y evaluaci√≥n de proyectos sociales II"], area: "proyectos"  },
            { nombre: "Gerencia de Ventas", creditos: 3, ciclo: 9, area: "marketing"  },
            { nombre: "Negociaci√≥n Comercial", creditos: 3, ciclo: 9, area: "marketing"  },
            { nombre: "Log√≠stica en el sector p√∫blico", creditos: 3, ciclo: 9, area: "log√≠stica"  },
            { nombre: "Distribuci√≥n y transporte", creditos: 3, ciclo: 9, area: "log√≠stica"  },
            // 10mo ciclo
            { nombre: " Desarrollo de Investigaci√≥n II", creditos: 3, ciclo: 10 },
            { nombre: "Gerencia General y Alta Direcci√≥n", creditos: 3, ciclo: 10, prereq: ["Direcci√≥n Estrat√©gica"] },
            { nombre: "Gesti√≥n de Pymes", creditos: 3, ciclo: 10 },
            { nombre: "Gerencia Estrat√©gica del Talento Humano", creditos: 3, ciclo: 10, prereq: ["Valoraci√≥n de puestos y gesti√≥n de las compensaciones"], area: "talento"  },
            { nombre: "Auditor√≠a en la Gesti√≥n del Talento Humano", creditos: 3, ciclo: 10, area: "talento"  },
            { nombre: "Direcci√≥n financiera", creditos: 3, ciclo: 10, prereq: ["Gesti√≥n de Riesgos Financieros"], area: "finanzas"  },
            { nombre: "Taller de Proyectos", creditos: 3, ciclo: 10, prereq: ["Gerencia de Proyectos"], area: "proyectos"  },
            { nombre: "Gerencia de Marketing", creditos: 3, ciclo: 10, area: "marketing"  },
            { nombre: "Neuromarketing", creditos: 3, ciclo: 10, area: "marketing"  },
            { nombre: "Gerencia Log√≠stica", creditos: 3, ciclo: 10, area: "log√≠stica"  },
            { nombre: "Log√≠stica Internacional", creditos: 3, ciclo: 10, area: "log√≠stica"  },
        ];

        const iconosAreas = {
            talento: "üë•",
            finanzas: "üè¶",
            proyectos: "üìÅ",
            marketing: "üí°",
            log√≠stica: "üè≠"
        };

        function guardarElectivas() {
            const seleccionadas = Array.from(document.querySelectorAll('.opt:checked')).map(e => e.value);
            localStorage.setItem('electivasSeleccionadas', JSON.stringify(seleccionadas));
        }

        function cargarElectivas() {
            const guardadas = JSON.parse(localStorage.getItem('electivasSeleccionadas') || '[]');
            document.querySelectorAll('.opt').forEach(opt => {
                opt.checked = guardadas.includes(opt.value);
            });
        }

        function calcularCreditosTotales() {
            const electivas = JSON.parse(localStorage.getItem('electivasSeleccionadas') || '[]');
            return cursos.reduce((suma, curso) => {
                if (curso.area && !electivas.includes(curso.area)) return suma;
                return suma + curso.creditos;
            }, 0);
        }

        function actualizarCreditos() {
            const electivas = JSON.parse(localStorage.getItem('electivasSeleccionadas') || '[]');
            let suma = 0;
            let total = 0;

            cursos.forEach(curso => {
                // Solo contar cursos que est√°n en las √°reas seleccionadas o que no tienen √°rea
                if (curso.area && !electivas.includes(curso.area)) return;
                
                total += curso.creditos;
                
                const estado = localStorage.getItem(curso.nombre);
                if (estado === "true") {
                    suma += curso.creditos;
                }
            });
            
            const minimo = 220;
            const creditos = document.getElementById("creditos");
            const totalCreditos = document.getElementById("total-creditos");
            const extra = document.getElementById("info-extra-creditos");
            const barra = document.getElementById("barra-progreso");
            const porcentaje = document.getElementById("porcentaje");
            
            if (creditos) creditos.textContent = suma;
            if (totalCreditos) totalCreditos.textContent = total;
            if (extra) extra.textContent = `(m√≠n: ${minimo})`;
            
            const porcentajeValor = total > 0 ? Math.round((suma / total) * 100) : 0;
            if (barra) barra.style.width = `${porcentajeValor}%`;
            if (porcentaje) porcentaje.textContent = porcentajeValor;
        }

        function renderCursos() {
            const contenedor = document.getElementById("contenedor-cursos");
            contenedor.innerHTML = ''; // Limpiar contenedor
            
            const electivas = Array.from(document.querySelectorAll('.opt:checked')).map(e => e.value);
            
            const agrupados = cursos.reduce((acc, curso) => {
                // Solo incluir cursos que est√°n en las √°reas seleccionadas o que no tienen √°rea
                if (curso.area && !electivas.includes(curso.area)) return acc;
                
                if (!acc[curso.ciclo]) acc[curso.ciclo] = [];
                acc[curso.ciclo].push(curso);
                return acc;
            }, {});

            Object.keys(agrupados).sort((a, b) => a - b).forEach(ciclo => {
                const divCiclo = document.createElement("div");
                divCiclo.className = "ciclo";
                const titulo = document.createElement("h2");
                titulo.textContent = `${ciclo}¬∞ Ciclo`;
                divCiclo.appendChild(titulo);

                agrupados[ciclo].forEach(curso => {
                    const estado = localStorage.getItem(curso.nombre) === "true";
                    const prereqCumplidos = !curso.prereq || curso.prereq.every(p => localStorage.getItem(p) === "true");

                    const div = document.createElement("div");
                    div.className = "curso";
                    if (estado) div.classList.add("tildado");
                    else if (prereqCumplidos) div.classList.add("activo");
                    else div.classList.add("bloqueado");
                    if (curso.area) div.classList.add("electiva");

                    const icono = curso.area ? `${iconosAreas[curso.area]} ` : "";
                    div.textContent = icono + curso.nombre;

                    const tooltip = document.createElement("div");
                    tooltip.className = "tooltip";
                    tooltip.textContent = `Cr√©ditos: ${curso.creditos}\nPrerrequisitos: ${curso.prereq ? curso.prereq.join(', ') : 'NR'}`;
                    div.appendChild(tooltip);

                    if (div.classList.contains("activo") || div.classList.contains("tildado")) {
                        div.addEventListener("click", () => {
                            const nuevo = !(localStorage.getItem(curso.nombre) === "true");
                            localStorage.setItem(curso.nombre, nuevo);
                            renderCursos();
                            actualizarCreditos();
                        });
                    }

                    divCiclo.appendChild(div);
                });

                contenedor.appendChild(divCiclo);
            });
        }

        // Event listeners para checkboxes de electivas
        document.querySelectorAll('.opt').forEach(opt => {
            opt.addEventListener('change', () => {
                const seleccionadas = Array.from(document.querySelectorAll('.opt:checked'));
                if (seleccionadas.length > 2) {
                    opt.checked = false;
                    alert('Solo puedes elegir 2 √°reas electivas.');
                    return;
                }
                guardarElectivas();
                renderCursos();
                actualizarCreditos();
            });
        });

        // Bot√≥n reset
        document.getElementById("reset").addEventListener("click", () => {
            // Eliminar el progreso de todos los cursos
            cursos.forEach(curso => {
                localStorage.removeItem(curso.nombre);
            });
        
            // Eliminar √°reas electivas seleccionadas
            localStorage.removeItem('electivasSeleccionadas');
        
            // Destildar checkboxes de electivas
            document.querySelectorAll('.opt').forEach(opt => opt.checked = false);
        
            // Volver a cargar todo
            renderCursos();
            actualizarCreditos();
        });

        // Inicializar la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', () => {
            cargarElectivas();
            renderCursos();
            actualizarCreditos();
        });
        
        // Tambi√©n ejecutar inmediatamente por si el DOM ya est√° cargado
        cargarElectivas();
        renderCursos();
        actualizarCreditos();
    </script>
</body>
</html>
